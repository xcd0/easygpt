## 16.4 方程式を管理するためのDCM関数

このセクションの関数は、方程式を管理するためのものです。

### 16.4.1 add\_v - DCM内で変数を作成する

v\_node\* add\_v( void\* av );

v\_node\* add\_v( void\* av, d\_node\* dn );

v\_node\* add\_v( void\* av, r\_node\* rn );

アプリケーションは、この変数を参照する際にFrustumによって使用されるポインタを渡します。
変数がどの寸法にも関連付けられていない場合、DCMは単純な変数を作成し、初期値はFrustumのDCM\_variable\_start\_value関数を介して必要に応じて見つかります。
変数が寸法に関連付けられている場合、アプリケーションはDCMの寸法または内部自由ノード（dnまたはrn）へのポインタも渡さなければならず、DCMはその寸法の測定値を初期値として使用します。
変数ノードへのポインタが返されます。

変数の寸法が次のセクションのadd\_eで方程式に追加されていない場合、参照寸法として扱われます。
参照寸法の値は、図形間の測定距離です。
この値は、value関数を使用して評価後に問い合わせることができます。

寸法が既に前のadd\_vの呼び出しによって変数に変換されている場合、同じ寸法ノードでの2回目の呼び出しは、以前に返されたポインタと同じポインタを返します。
したがって、この場合、アプリケーションはadd\_vによって返されたポインタの値を保存する必要はありません。必要な場合は、この関数を呼び出して値を取得することができます。

### 16.4.2 add\_e - DCM内で方程式を作成する

e\_node\* add\_e( void\* ae );  // 線形、非線形、不等式

e\_node\* add\_e( double c );  // 線形方程式のみ

e\_node\* add\_e( void\* ae, double c ); // 線形方程式のみ

アプリケーションは、ポインタ、方程式の定数項として使用されるdouble、またはその両方を渡します。
DCMは、方程式ノードへのポインタを返します。
アプリケーションがポインタを渡した場合、DCMはこれをフラスタムを介して方程式を参照するために使用します。

add\_eの最初の形式が使用される場合、DCMはフラスタム関数DCM\_equation\_typeを通じて問い合わせ、方程式が線形方程式、剛体線形方程式、非線形方程式、または不等式であるかを判断します。

定数項を渡すためにadd\_eの2番目または3番目の形式が使用される場合、現在のDCMはDCM\_equation\_typeを呼び出さず、方程式がDCM\_LINEAR\_EQUATION型であると仮定します。
また、定数項の値は変更されないと仮定されます。
したがって、DCMは定数項の値を問い合わせるためにフラスタム関数DCM\_equation\_constant\_valueを呼び出すことはありません。

新しいアプリケーションでは、これらの関数のバリエーション（つまりDCM\_RIGID\_LINEAR\_EQUATION）に対して、期待される方程式のタイプを返すようにDCM\_equation\_type関数を登録することが推奨されます。
なぜなら、将来の2D DCMのバージョンでは、同じadd\_e関数のバリエーションを使用する追加の式タイプをサポートする可能性があるためです。

アプリケーションが線形方程式の定数項と係数項が変更されないことを知っている場合、モデルを過剰定義せずに過拘束だが整合した（OCC）制約スキームを解決するために、剛体線形方程式を作成することが好ましいです（[2.7.2 Over-constrained but consistent models](2.7._Solving_over-defined_models.md)を参照）。

なお、DCMに定数値が渡される場合、方程式は線形方程式であると仮定されるため、非線形方程式や不等式は関数の最初の形式を使用する必要があります。

### 16.4.3 add\_v\_to\_e - 方程式に変数を追加する

DCM\_logical add\_v\_to\_e( void\* ac, e\_node\* en, v\_node\* vn );

DCM\_logical add\_v\_to\_e( double cf, e\_node\* en, v\_node\* vn );

アプリケーションは、方程式へのポインタ（add\_eによって返される）と変数へのポインタ（add\_vによって返される）をDCMに渡します。アプリケーションはまた、この方程式内の変数の係数の値を問い合わせるためにFrustumによって使用されるポインタ（ac）または係数の値（cf）を渡します。

非線形の方程式または不等式の場合、この関数の最初の形式のみを使用できます。これらの場合、（ac）の値は無視されます。

係数の数値値が渡された場合、DCMはそれが変更されないと仮定し、関数DCM\_equation\_coefficient\_valueを呼び出しません。

変数が既に与えられた方程式に追加されている場合、それは削除されます。変数が方程式に追加された場合はDCM\_TRUEを、削除された場合はDCM\_FALSEを返します。

関数は、変数を方程式から拒否する場合にもDCM\_FALSEを返します。これは、線形方程式の変数の寸法が新しい変数の寸法と互換性がない場合に発生します。DCMでは、すべての長さの単位を持つ変数の寸法またはすべての角度の単位を持つ変数の寸法のみが許可されます。ただし、単純な変数は、いずれの寸法タイプとも自由に混在させることができます。

一般的には、線形方程式の定数項と係数項が変更されないことがわかっている場合、剛体な線形方程式を作成することが好ましいです。この場合、add\_v\_to\_eのいずれのバリアントを使用して、各係数の値を指定することができます。

ポインタacはDCM\_NULLにすることができます。これは、Frustumが特定の方程式内の特定の変数を参照する際に、3つのポインタすべてを渡すためです（Frustum関数DCM\_equation\_coefficient\_valueを参照）。

### 16.4.4 add\_g\_to\_e - 非線形方程式に図形を追加する

DCM\_logical add\_g\_to\_e( void\* ac, e\_node\* en, g\_node\* gn );

      // 非線形方程式のみ

この関数は、DCMに図形gnが非線形方程式enに含まれていることを通知するために使用されます。
ポインタacは現在使用されていません。
この関数は、方程式から図形を削除するためにも使用できます。その場合、DCM\_FALSEを返します。それ以外の場合はDCM\_TRUEを返します。

### 16.4.5 add\_p\_to\_e - 非線形方程式にヘルプパラメータを追加する

DCM\_logical add\_p\_to\_e( void\* ac, e\_node\* en, p\_node\* pn );

        // 非線形方程式のみ

この関数は、DCMにヘルプパラメータp\_node pnが非線形方程式enにあることを通知するために使用されます。
この関数は、p\_nodeを方程式から削除するためにも使用できます。その場合、DCM\_FALSEを返します。それ以外の場合はDCM\_TRUEを返します。
ポインタacは、p\_nodeに対してDCM\_equation\_p\_node\_derivative\_value関数が呼び出されたときに、アプリケーションに戻されます。
