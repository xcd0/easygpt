## 16.2 Configure global DCM behaviour

Each DCM instances has a number of global options that can be configured in order to customise the behaviour of various features. 
These can be set and enquired using the set\_option and related functions.

- set\_option – Change the current value of a given option to the specified new value.
- option\_state – Enquire the current value for a given option.
- option\_default – Enquire the default value for a given option.

These functions allow specific behavioural changes to be delivered through an option that does not require a change to the interface (and would typically only be made available through a major release).

With the provided enquiry functions, it is also possible to code up tests to identify when DCM defaults may change from version to version, so that any necessary changes may be implemented on an application side.

Note that while the previous set\_option function is still supported, all future options will only be available through the new set\_option function.

It will be safe to call the set\_option and its related functions even with invalid data. 
The return value from these functions allows an application to check that the call has an effect and to code for the possibility of retired values:

- DCM\_SET\_OPT\_OK\_CHANGE – The DCM instance state has changed. 
The specified option has been set.
- DCM\_SET\_OPT\_OK\_NO\_CHANGE – Indicates that there was no change to the DCM state because the specified value of the option was the same as the current DCM state.
- DCM\_SET\_OPT\_INVALID\_KEY – The key is not supported.
- DCM\_SET\_OPT\_INVALID\_VALUE – The key is valid but the value is not supported.
- DCM\_SET\_OPT\_ERROR – An internal error has occurred.

### 16.2.1 set\_option - Set global option

DCM\_set\_option\_return set\_option(int key, int value);

This function is used to set the global option using the key and value provided. 
All changes affect only the specific instance of the DCM for which set\_option is called.

The first argument (key) is a unique integer that defines the functionality to configure and the second argument (value) determines the state of the option.

The keys and values are defined in the header file dcm\_op\_defs.h. 
This is an optional header file for applications to include as it is not included by the other 2D DCM header files. 
In a major release all keys and values will have a #define'd name in this header file.

The values supported for a given key depend on the type of option being set.  Some keys take an on/off value, some take the major version of 2D DCM and some keys only accept specific values.

The integer values can be found in section [For backwards compatibility, i.e. 
to allow rigid dimensions to change during an incremental evaluation, the value DCM\_OPVAL\_ON should be set. 
This also influences the result of the model\_satisfied and satisfied functions, as explained in 16.5.24 model\_satisfied – Return if the constraints in a model are solved 16.5.24 model\_satisfied – Return if the constraints in a model are solved and 16.5.25 satisfied – Return if a constraint is in a solved state 16.5.25 satisfied – Return if a constraint is in a solved state.set\_option integer values](#_Ref72230206).

Options supported via this interface are provided for two distinct purposes:

- To allow alternative functionality of certain features where different customer applications have evolved different requirements.

- To allow access to legacy versions of certain algorithms to all DCM to continue to offer old behaviour, even where this may be considered incorrect in general, in order to give repeatable results.

In some cases, new key/value pairs may be introduced in patch versions of 2D DCM in order to version new bug fixes. 
Applications may wish to implement a generic method to call this functionality so that they can test different option settings without requiring a rebuild of their application code.

### 16.2.2 Option classification

The following sections group the option descriptions according to whether they are:

- Behaviour options: These offer alternatives to current DCM behaviour of various functions and features. 
New (and existing) DCM integrations should consider each option to see which of the options available best meets their requirements.

- Interface behaviour: Options to control how the interface functions are called. 
Changes to these options will require coding changes.

- Solution control: These options affect the which solution DCM will return for a particular evaluation. 
The options allow for preferred behaviour to be chosen and to balance solving capability with performance.

- Function-specific: These options change the behaviour of specific DCM functions, such as auto-dimensioning.

- Versioning options: These options are available to maintain legacy behaviour. 
We encourage applications to use the latest/default values of these options where possible. 
The non-default values for each of these options should be considered deprecated. 
New applications should not need to change the values of any of the keys in this section.

Over future DCM versions, some of the existing behaviour options will be moved to the versioning, or legacy, category, when the old versions are deprecated.

### 16.2.3 Behaviour options - interface behaviour

These options detailed within this section are those which offer alternatives to current DCM behaviour of various functions and features. 
New (and existing) DCM integrations should consider each option to see which of the options available best meets their requirements.

All the values for each option key should be considered equally supported, in general, although certain cases have recommended values as documented below.

#### 16.2.3.1 Call abort function to allow application to quit long DCM operations

Key: DCM\_OPKEY\_ABORT

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF (default)

The DCM\_OPKEY\_ABORT option controls whether the DCM will call the Frustum function [DCM\_abort\_dcm](17.12._Miscellaneous_functions.md)
When it is OFF (the default) [DCM\_abort\_dcm](17.12._Miscellaneous_functions.md)

#### 16.2.3.2 Parallel computation of partitions

Key: DCM\_OPKEY\_MULTITHREAD\_PARTITIONS\_MODE

- DCM\_OPVAL\_OFF (default)
- DCM\_OPVAL\_LEVEL\_1 - for debugging
- DCM\_OPVAL\_LEVEL\_2

This option controls whether DCM will output tasks to run in parallel for evaluation functions when it can do so for whole partitions. 
This option has no effect unless the frustum function DCM\_run\_mulitple\_tasks is registered.

- Off - By default, no parallel tasks will be output and solving will use a single thread (unless other specific algorithms can be parallelsed).
- Level 1 - At this level, DCM will output the maximum number of separate tasks, regardless of their size, in order to allow stress-testing of integrations.
- Level 2 - At this level, use internal heuristics to aim to output a balanced set of tasks that should most benefit from being run in parallel threads.

#### 16.2.3.3 Output multiple tasks to parallelise curve length computations

Key: DCM\_OPKEY\_MULTITHREAD\_CURVELENGTH

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

By default, the DCM will split the computation of dimensions of type DCM\_CURVE\_LENGTH into smaller tasks that can be run in parallel. 
This will only be done when the curve length calculation is sufficiently large to benefit from being split in this manner. 
This functionality can be disabled by setting the value to DCM\_OPVAL\_OFF. 
See section [15.3 Symmetric multiprocessing (SMP)](Symmetric multiprocessing.md)

#### 16.2.3.4 Rigid curve length options

Key: DCM\_OPKEY\_ALLOW\_RIGID\_CURVE\_LENGTH

- DCM\_OPVAL\_OFF (default)
- DCM\_OPVAL\_ON
- DCM\_OPVAL\_ON\_CC

If set to DCM\_OPVAL\_ON, the DCM will call the Frustum function DCM\_dimension\_rigid on curve length dimensions, allowing the application to specify if the dimension is rigid or not.

However, these dimensions will not be used in part of the algorithm for determining if the model is overconstrained-but-consistent, which may mean the model fails to solve in some situations.

If the option is set to DCM\_OPVAL\_ON\_OCC these dimensions will also be used in the OCC algorithm, but this will have some performance cost.

#### 16.2.3.5 Cache soft references passed on evaluate

Key: DCM\_OPKEY\_MANAGE\_CHANGING\_SOFT\_REFERENCES

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF (default)

Successive calls to re\_evaluate() can give different solutions if different soft references are supplied. 
This option allows the caching of soft references passed on evaluations, to ensure consistency of solutions in situations where different soft references may be used on successive evaluations.

#### 16.2.3.6 Allow rigid arc length dimensions

Key: DCM\_OPKEY\_ALLOW\_RIGID\_ARC\_LENGTH

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF (default)
- DCM\_OPVAL\_ON\_OCC

This option specifies whether the DCM will allow rigid arc lengths.

If it is set to DCM\_OPVAL\_ON the DCM will call the frustum function DCM\_dimension\_rigid on arc length dimensions, allowing the application to specify if the dimension is rigid or not.

The dimensions will not be used in determining if the model is overconstrained-but-consistent, which may mean the model fails to solve in some situations. 
If the option is set to DCM\_OPVAL\_ON\_OCC these dimensions will also be used in the overconstrained-but-consistent algorithm, but this will have some performance cost. 
See section [4.2 Rigid dimensions](4.2._Rigid_dimensions.md)

#### 16.2.3.7 Store geometric positions within DCM

Key: DCM\_OPKEY\_CACHE\_FRUSTUM

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

The CACHE\_FRUSTUM option controls if the DCM will store the geometric position of geometry inside the DCM itself, or call the Frustum whenever it needs this information. 
The default is ON (i.e. 
the positions will be stored.) When this option is ON the DCM will only call the Frustum functions that return the location and size of points, lines, circles and ellipses at most twice for each geometry during any DCM call. 
When it is OFF the Frustum functions may be called many times, but the amount of data stored by the DCM is reduced slightly.

### 16.2.4 Behaviour options - solution control

This section includes options to allow various special case geometry values or changes, depending on the application preference. 
It also includes options to enable or disable various optional solving algorithms which will affect the quality of output at a cost of additional computation time.

All the values for each option key should be considered equally supported, in general, although certain cases have recommended values as documented below.

#### 16.2.4.1 Allow zero radius circles

Key: DCM\_OPKEY\_ALLOW\_ZERO\_RADIUS

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

The ALLOW\_ZERO\_RADIUS option controls if the DCM will solve circles with zero radius values. 
When it is OFF the DCM will mark any circles with a zero radius dimension as inconsistent. 
Note that it is possible to allow zero radius values on each circle individually via the Frustum function DCM\_circle\_allow\_zero\_radius.

#### 16.2.4.2 Allow circle inversion

Key: DCM\_OPKEY\_ALLOW\_CIRCLE\_INVERSION

- DCM\_OPVAL\_ALLOW\_CIRCLE\_INVERSION\_ON
- DCM\_OPVAL\_ALLOW\_CIRCLE\_INVERSION\_OFF (default)
- DCM\_OPVAL\_ALLOW\_CIRCLE\_INVERSION\_OFF\_STRICT

The ALLOW\_CIRCLE\_INVERSION option controls if the DCM will invert the sense of circles. 
This is equivalent to solving to negative radius values but instead of actually setting the value to be negative, the DCM will return a positive value and inform the application that its sense needs to be inverted. 
Typically this will require an arc to change direction in the application. 
When this option is OFF the DCM will mark as not solved models where the only solution would be for a negative radius circle. 
Note that it is possible to allow individual circles to be inverted via the Frustum function DCM\_circle\_allow\_inversion.

#### 16.2.4.3 Allow negative scaling on uni-scalable sets and uni-scalable splines

Key: DCM\_OPKEY\_UNI\_SCALABLE\_NEGATIVE\_SCALING

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF (default)

By default, the DCM will not apply a negative scaling factor to a uni-scalable set. 
However, it is possible to allow negative scaling by setting this option to DCM\_OPVAL\_ON.

#### 16.2.4.4 Allow negative scaling on bi-scalable sets and bi-scalable splines

Key: DCM\_OPKEY\_BI\_SCALABLE\_NEGATIVE\_SCALING\_1

Key: DCM\_OPKEY\_BI\_SCALABLE\_NEGATIVE\_SCALING\_2

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF (default)

By default, the DCM will not apply a negative scaling factor to bi-scalable sets or bi-scalable splines. 
These options can be set to DCM\_OPVAL\_ON to allow a negative scaling in one or both directions.

#### 16.2.4.5 Solve nodes non-algebraically

Key: DCM\_OPKEY\_ANALYSE\_UNSOLVED

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

The ANALYSE\_UNSOLVED option controls the amount of analysis the DCM will do when it is trying to solve a model. 
When it is ON (the default) the DCM will determine if nodes can be solved non-algebraically. 
Whether these nodes will then be solved or not depends upon the option below. 
When it is OFF all of these nodes will be marked as over-defined.

When a model includes a large number of non-algebraic or over-defined geometries switching this option off may improve the performance considerably.

Note that switching OFF the ANALYSE\_UNSOLVED option will make the DCM behave as if ANALYSE\_OVERDEFINED and SOLVE\_NON\_ALGEBRAIC are also OFF.

#### 16.2.4.6 Control analysis on over-dimensioned nodes

Key: DCM\_OPKEY\_ANALYSE\_OVERDEFINED

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

The ANALYSE\_OVERDEFINED option controls how much analysis is performed on over-dimensioned nodes. 
When it is ON (the default) the DCM will minimise the number of dimensions that are marked as over-defined.

When it is OFF, the DCM may mark more than the minimum number of dimensions as over-defined. 
However, when a model includes a large number of over-defined geometries switching this option off may improve the performance considerably.

#### 16.2.4.7 Solve points, lines and circles non-algebraically

Key: DCM\_OPKEY\_SOLVE\_NON\_ALGEBRAIC

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

The SOLVE\_NON\_ALGEBRAIC option controls if the DCM will use non-algebraic solving on models that contain points, lines and circles. 
When it is ON (the default), the DCM will attempt to solve nodes that are determined to be non-algebraic.

When it is OFF the DCM will mark these nodes as non-algebraic, but the solver will leave these as they are. 
However, when a model includes a large number of non-algebraic geometries switching this option off may improve the performance considerably.

Further details of the ANALYSE\_UNSOLVED, ANALYSE\_OVERDEFINED and SOLVE\_NON\_ALGEBRAIC options are in section [2.5.5 Algebraic and non-algebraic solving](2.5._Evaluating_the_model.md)

#### 16.2.4.8 Perform additional analysis on non-consistent regions

2D DCM solving generally aims to use analytic methods to solve the constraints within a system where possible. 
The solving method generated during a full evaluation is designed to be useful for multiple solves where the input parameters are varied.

In certain cases, this approach will result in a solving method that does not find a solution for a particular combination of input parameters, i.e. 
for the initial input geometry positions and dimension values. 
Some of the constraint statuses in those cases would usually be set to "not consistent", since no consistent solution had been found.

In these cases, DCM can use a fall-back computation mode in order to fix up these not-consistent models. 
This algorithm will override the original solving method defined, typically using more numerical methods, to achieve a solution for these input values. 
This algorithm can be enabled or disabled for all solving using the "resolve not-consistent" option keys. 
A separate key is provided for static solving (i.e. 
evaluate / re\_evaluate / move\_and\_evaluate) and dragging (dynamic\_evaluate).

This additional analysis increases the number of under-defined models which can be solved by the DCM. 
Models that are well-defined are not affected. 
Typically, models that are highly under-defined and a long way from solution will benefit from this analysis. 
Such models would otherwise only solve when using relaxation solving mode.

Key: DCM\_OPKEY\_EVAL\_RESOLVE\_NOT\_CONSISTENT

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF

For static solves the key DCM\_OPKEY\_EVAL\_RESOLVE\_NOT\_CONSISTENT controls whether the fall-back analysis is performed. 
This is enabled by default. 
In general, it will only be advisable to turn this function OFF when seeking to reproduce solving behaviour from older versions of the DCM or when making repeated calls to re\_evaluate in a loop where solving time is more important than finding a valid solution for each individual set of values (e.g. 
during a shape optimisation operation).

Key: DCM\_OPKEY\_DRAG\_RESOLVE\_NOT\_CONSISTENT

- DCM\_OPVAL\_OFF (integer value 0) – Using this value will disable the fall-back method for computing a solution during dragging. 
This will give the behaviour that was the default with 2D DCM version 69 and earlier.
- DCM\_OPVAL\_LEVEL\_1 / DCM\_OPVAL\_ON (integer value 1) – Using the value of 1 for this key will give the resolve not-consistent behaviour that was available in version 69 and before. 
The latest improvements will not be activated.
- DCM\_OPVAL\_LEVEL\_2 (integer value 2) – This is the default value. 
With this setting, DCM will use the latest and best version of the fall-back method for computing a solution during dragging.

For dynamic\_evaluate this key is used. 
Three values are currently supported.

If it is necessary to resolve not-consistent nodes, the method by which the model is solved will typically be very different from that used if the functionality was not required. 
This can lead to unexpected changes in the solving between successive steps during dragging operations. 
The analysis can also be expected to take longer time than a regular solve. 
For these reasons, some customers may prefer to disable this functionality.

- Dragging with resolve not-consistent enabled:

- Some drag steps (depending on inputs) will now solve when previously they would have failed.
- For those positions that would have otherwise failed:

- Solving may take significantly longer than the typical step.
- The solution may "jump" more from one solve step to another, as the use of the fall-back solve switches in or out.

- If the key value is set to level 1, then there will be a larger range of input positions / transforms for which DCM will still fail to compute a solution than with the level set to 2. However, the behaviour will be more similar to that with the option enabled in older DCM versions.

- Dragging with resolve not-consistent disabled:

- DCM may fail to compute a solution for certain drag inputs.
- Fewer jumps in solution are to be expected – the change in outputs will align closely to a change in inputs.
- All drag steps will take a similar amount of time to complete.

An example model which shows this characteristic behaviour is a chain of points dimensioned to each other. 
With standard and minimum move dragging, it is not normally possible to stretch out the chain to its full extension using dynamic\_evaluate to drag the end point. 
If the DCM\_OPKEY\_DRAG\_RESOLVE\_NOT\_CONSISTENT option is at level 1 or above, then the chain can be stretched out, but there will be some points where a large change in the positions of some points occurs, i.e. 
jumps. 
A smoother dragging behaviour can be obtained using relaxation solve mode. 
However, this mode will be slower for all steps.

#### 16.2.4.9 Minimize the change in value of any help paramenters during solve

Key: DCM\_OPKEY\_MINIMIZE\_HELP\_PARAMETER\_CHANGE

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF (default)

Determines whether the DCM attempts to minimise the change in values of any help parameters in the model during a solve. 
By default, the DCM will solve constraints to parametric geometry so that they act at a parameter approximating the help parameter as quickly as possible. 
In some difficult to solve situations, the standard algorithm can result in large changes to the help parameter value from the starting value, however.

If the option is ON, then the DCM uses additional functionality to attempt to minimise the change in value of the help parameter. 
These extra algorithms will have a small additional performance cost.

This option will typically be useful if the application implements a dragging algorithm that calls undo\_evaluation after every step of the drag in order to prevent hysteresis effects. 
In standard DCM solving, it is possible that solving of constraints to parametric geometry may be unstable in this case. 
The result may be that small changes in input produce large changes in the output positions. 
This option will improve the consistency of successive drag steps if it is enabled.

If enabled, this option will affect the solution of constraints to parametric geometry (including splines) when the model is under-defined and a fixed p\_node has not been defined. 
It is therefore only recommended that this option is enabled in order to improve the solving behaviour when specific problems have been identified.

#### 16.2.4.10 Improve solving behaviour for under-defined points connected by distance dimensions

Key: DCM\_OPKEY\_CHAIN\_SOLVING

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF (default)

Chain solving functionality is designed to guarantee solutions for models where a number of under-defined points are connected by distance dimensions only. 
Dragging behaviour of such cases is improved if chain solving is enabled. 
The option is set to OFF by default.

#### 16.2.4.11 Propagate solve status from internal constraints to relevant external

Key: DCM\_OPKEY\_USE\_WORST\_PARTIAL\_STATUS

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF (default)

Some constraints may imply other constraints must also be solved. 
For example, a distance dimension between two lines implies that the lines are parallel. 
The 2D DCM will internally add the extra parallel constraint in that situation. 
It is possible that the 2D DCM will identify that the parallel constraint causes the model to be over-defined, whilst the distance component is theoretically acceptable.

The default behaviour of the 2D DCM is that the distance dimension may be given a status of DCM\_D\_NOT\_CHANGED, whilst the internal constraint would have the DCM\_D\_OVER\_DEFINED status.

Setting this option to ON allows the application to force the 2D DCM to copy the over-defined status of the internal constraint onto the original constraint, marking it over-defined. 
This will give better diagnostics for failing models and so it is recommended that applications turn this switch on.

This option is not the default because it would cause changes to existing application behaviour that is undesirable. 
Applications working with legacy data that require DCM to give the same results as previous versions should leave the setting at the default for old models.

#### 16.2.4.12 Identify singular under-defined

Key: DCM\_OPKEY\_IDENTIFY\_SINGULAR\_UNDERDEFINED

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF (default)

This option enables an additional algorithm to analyse the statuses of under-defined geometry. 
When this option is enabled, DCM will identify certain under-defined geometry as "singular under-defined".

It may not be possible to fully define geometry that has been classified as singular under-defined by addition of further constraints in the model, without changing the existing constraint scheme.

For full details see sections [2.6.2 Singular under-defined](2.6._Ambiguous_models.md)

#### 16.2.4.13 Solve normal constraints using rotation or translation

Solve normal constraints using rotation or translation

Key: DCM\_OPKEY\_NORMAL\_SOLVING\_MODE

- DCM\_OPVAL\_NORMAL\_TRANSLATION
- DCM\_OPVAL\_NORMAL\_ROTATION (default)

This option specifies whether the DCM tends to solve normal constraints using rotation or translation when the model is under-defined.

DCM\_OPVAL\_NORMAL\_ROTATION will rotate the geometry to satisfy the normal constraint. 
This option is likely to minimise the movement of the geometry and provide a more intuitive solution. 
Note that this option was introduced in version 65, so the application may wish to select DCM\_OPVAL\_NORMAL\_TRANSLATION for legacy models to avoid behaviour changes.

DCM\_OPVAL\_NORMAL\_TRANSLATION will translate the geometry to satisfy the normal constraint. 
This option is likely to result in larger movement of the geometry than rotation.

#### 16.2.4.14 Control solving status for degenerate conics

Key: DCM\_OPKEY\_FAIL\_DEGENERATE\_CONICS

- 0 (default), 1, 2

Determines the solving status that DCM applies to conic section curves based on analysis of their shape. 
Useful when an application does not want solutions that result in degenerate conics curves - that is, curves for which an underlying conic shape cannot be computed.

- Option value 0 (the default):



No conic curves are considered degenerate during solving and so in general the conic curve status will not be affected by its shape (e.g. 
if linear, or having coincident control points).



However certain constraints that depend on well-defined derivatives may result in solve failures: For example, a tangent constraint at an end should not solve if the derivative there is zero.
- Option value 1:



A conic will be identified as degenerate if two of the control points of the conic are within linear resolution of each other.



If the control point is coincident to either the start or the end, the conic curve will be linear with a zero derivative at the location with coincident curves. 
If the start and end are coincident, the curve would be linear and overlapping, with a zero derivative at the nearest point to the control point.
- Option value 2:



If the conic curve shape is such that the overall chordal deviation is less than linear resolution then the curve will be considered degenerate. 
This effectively means that the three control points are all coincident (within resolutions) to a line, or that the rho value is sufficiently close to zero.



Additionally, with this option a conic with rho value with linear resolution of 1 will be considered degenerate for solving. 
Such a curve will have two linear sections with a tangent discontinuity at the middle.

### 16.2.5 Behaviour options - function specific cases

These globals switches change the behaviour of certain DCM functionalities.

#### 16.2.5.1 Return help point positions for automatic constraints to analytic curved geometries

Key: DCM\_OPKEY\_AUTOCON\_HELP\_POINTS

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

Controls whether the DCM returns help point positions for automatic constraints to analytic curved geometries. 
When help points are ON (the default), the DCM will supply help point values and the application must use these values when applying the constraints. 
When this option is OFF the DCM will not supply help point positions and the application should not supply its own values. 
N.B. 
This option does not affect the deduce\_constraints or autodimension functions.

#### 16.2.5.2 Return one or both angles between geometries during auto-dimension

Key: DCM\_OPKEY\_AUTODIM\_ANGLES

- DCM\_OPVAL\_AUTODIM\_ANGLES\_ONE  (default)
- DCM\_OPVAL\_AUTODIM\_ANGLES\_BOTH

The autodimension functionality will detect and offer dimensions to remove freedoms from a model, but to optimise performance, it usually offers a dimension once between two g\_nodes – i.e. 
if it offers A, B it does not offer B, A.

For angle dimensions, the order in which g\_nodes are specified is important since it is used to measure the value of the dimension. 
Autodimension requires that dimensions are added in exactly the form suggested, so with the default option of DCM\_OPVAL\_AUTODIM\_ANGLES\_ONE, it may be that the desired alternative angle is not the one output from DCM.

If the option is set to DCM\_OPVAL\_AUTODIM\_ANGLES\_BOTH, then DCM will return both versions of each angle it finds, both when requesting weights and when offering dimensions (although if the first angle is applied, then naturally the second will not be offered since it would over-dimension the model).

#### 16.2.5.3 Return maximum or minimum set of constraints during autoconstrain

Key: DCM\_OPKEY\_AUTOCON\_CONSTRAINTS

- DCM\_OPVAL\_AUTOCON\_MAX\_CONSTRAINTS
- DCM\_OPVAL\_AUTOCON\_MIN\_CONSTRAINTS (default)

Determines whether the DCM autoconstrain function supplies only the minimum set of constraints necessary (the default) or supplies the maximum set of constraints possible. 
See [13.1.3 Automatic constraining](13.1._Autoconstraining.md)
N.B. 
This option does not affect the deduce\_constraints or autodimension functions.

#### 16.2.5.4 Deduce\_constraints returns maximum or minimum constraints

Key: DCM\_OPKEY\_DEDUCE\_CONSTRAINTS\_LEVEL

- DCM\_OPVAL\_LEVEL\_2
- DCM\_OPVAL\_LEVEL\_1 (default)

This option controls whether the minimum or maximum number of constraints are output when using deduce\_constraints.

- Level 1 - At this level, DCM will output the minimum number of constraints that need to be added to fully define all the relationships that are found
- Level 2 - At this level, DCM will output all the relationships that are found. 
N.B. 
this option will not affect the number of geometries that are identified in equivalence classes - the DCM will always list the full set of mutually parallel lines, for example. 
Therefore it is necessary for the application to apply all the constraints within the equivalence class.

#### 16.2.5.5 Control if the model\_satisfied function will consider the position of help points

Key: DCM\_OPKEY\_MODEL\_SATISFIED\_CHECK\_HELP\_POINTS

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

This option specifies if the model\_satisfied function will consider the position of help points when returning if a model is in a satisfied position or not.

If the option is off, then models which are geometrically satisfied will return DCM\_SS\_SATISFIED from model\_satisfied even if help points are not satisfied.

If the option is on, then models which are geometrically satisfied, but which have help points in unsatisfied positions, will return DCM\_SS\_HELP\_POINTS\_NOT\_SATISFIED following a call to model\_satisfied. 
See the model\_satisfied function description for more detail.

#### 16.2.5.6 Control if model\_satisfied produces a comprehensive result

Key: DCM\_OPKEY\_MODEL\_SATISFIED\_FAST\_QUIT

- DCM\_OPVAL\_OFF (default)
- DCM\_OPVAL\_ON

This option specifies if the model\_satisfied function will assess the satisfied status of all constraint nodes (the default) or if it will return immediately on finding an unsatisfied node.

If this option is enabled, the return from the model\_satisfied function for an unsatisfied model will always be DCM\_SS\_NOT\_UNSATISFIED for any sort of unsatisfied result found. 
DCM is not guaranteed to call the frustum to identify the unsatisfied constraint found.

### 16.2.6 Versioning options

These options are available to maintain legacy behaviour. 
We encourage applications to use the latest/default values of these options where possible.

New applications should not need to change the values of any of the keys in this section.

Existing applications are encouraged to adapt their integrations so that they only set the older values for any of these keys where there is a specific requirement to obtain the older behaviour. 
For example, when loading and solving a sketch built with an earlier version of the 2D DCM, as part of a history based modelling system, the older values might be set. 
But in the same application, where a new sketch is being created or a new history based feature added, the latest option value should be set instead so that the best current behaviour is obtained and recorded for future solves.

#### 16.2.6.1 Revert to version 49 autoconstrain algorithm

Key: DCM\_OPKEY\_AUTOCON\_V49

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF (default)

This option has been introduced for backwards compatibility purposes. 
It allows an application to force the 2D DCM to revert to the autoconstrain algorithm as it was in version 49. The default is to use the new, much more efficient, algorithm but customers requiring identical results may wish to use this option for older models.

#### 16.2.6.2 Update help point and parameters on each incremental evaluation

Key: DCM\_OPKEY\_INCREMENTAL\_HELP\_POINT\_UPDATE

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

This option specifies whether the help point and parameters are enquired from the application on each incremental evaluation. 
This is required for correct behaviour of undo\_evaluation. 
However, very old integrations may need to turn this option off for compatibility.

#### 16.2.6.3 Disable strict chirality checks

Key: DCM\_OPKEY\_CHIRALITY\_STRICT

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

This option allows applications to disable the strictest chirality checking that the DCM performs. 
This additional checking was introduced in version 48.0. Applications that are solving models built with DCM versions before this may wish to turn off strict chirality for these models only in order to ensure the DCM gives the same solution to their models.

#### 16.2.6.4 Improve solving for models where dimensions with values are far from measured value

Key: DCM\_OPKEY\_LARGE\_CHANGE\_SOLVING

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

This option enables an algorithm to improve the solving for models where the dimension with values are a long way from the measured value. 
This option is enabled by default.

This algorithm was introduced in version 60. The switch is provided to enable applications that require compatibility with earlier versions of 2D DCM to turn off this algorithm. 
It is likely that the effect of setting the switch to OFF will cause some models to fail to solve (being found not-consistent) when they would otherwise succeed, so this is only recommended for those applications that would be using an alternative method such as performing repeated evaluates at different dimension values.

#### 16.2.6.5 Control which status codes are returned

Key: DCM\_OPKEY\_STATUS\_VERSION

- DCM\_OPVAL\_STATUS\_400 - Output only status codes that were present in version 4.0.0. Any status codes introduced since this version will not be returned.
- DCM\_OPVAL\_STATUS\_410 - Output the status codes that were present in version 4.1.0.
- DCM\_OPVAL\_STATUS\_420 (default) - Output the status codes that were present in version 4.2.0 and all subsequent versions.
- DCM\_OPVAL\_STATUS\_CURRENT - Return the newest status codes.

The STATUS\_VERSION options control which status codes are returned by the DCM or output via the Frustum. 
The default behaviour is to return all status codes that are defined. 
Between version 4.0.0 and 4.1.0, and also between 4.1.0 and 4.2.0, new status codes were introduced. 
Applications can choose to use only the status codes that were present in a particular version to avoid problems with upgrading.

It is recommended that new applications should be written to use all the available status codes but should call the set\_option function with an argument of DCM\_OPVAL\_STATUS\_420. In current DCM, the options DCM\_OPVAL\_STATUS\_420 and DCM\_OPVAL\_STATUS\_CURRENT are equivalent. 
However, applications which use DCM\_OPVAL\_STATUS\_420 will be unaffected by any changes that are introduced in future releases. 
See the chapter [14\. Status Codes](14._Status_Codes.md)

#### 16.2.6.6 Improved solution stability in dynamic\_evaluate

Key: DCM\_OPKEY\_DRAG\_CONSISTENT\_BEHAVIOUR

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

As of version 48.0, the dynamic\_evaluate algorithm was improved to give better, more stable solutions. 
However, this can give different results from version 70.0. Setting the value to DCM\_OPVAL\_OFF should give solutions more like version 70.0 and earlier.

#### 16.2.6.7 Improved solution stability in move\_and\_evaluate

Key: DCM\_OPKEY\_MOVE\_AND\_EVALUATE\_SOLVE\_STABILITY

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

As of version 70.0, the move\_and\_evaluate algorithm was improved to give better, more stable solutions. 
However, this can give different results from version 70.0. Setting the value to DCM\_OPVAL\_OFF should give solutions more like version 70.0 and earlier.

#### 16.2.6.8 Revert to version 56 auto-dimension algorithm

Key: DCM\_OPKEY\_AUTODIM\_V56

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF (default)

This option has been introduced for backwards compatibility purposes. 
It allows an application to force the 2D DCM to revert to the autodimension algorithm as it was in version 56.

Significant improvements were made to the autodimension algorithm for version 57. Some of these changes may cause a change in the order in which DCM would offer dimensions to the application, and the actual dimensions that would be offered. 
The changes affected by this option include:

- Increased range of constraints that will be offered onto DCM\_PARAMETRIC curves.
- Improved reliability. 
In version 56 and earlier, some cases have been found where DCM would over-define the model. 
The new algorithm addresses this issue.
- Improved repeatability. 
With version 56 and earlier, autodimension results were sometimes affected by the order in which previous DCM calls have been made.

The default is to use the new algorithm but customers requiring identical results may wish to use this option for older models.

#### 16.2.6.9 Pre-resolve level

Key: DCM\_OPKEY\_PRE\_RESOLVE\_LEVEL

- DCM\_OPVAL\_LEVEL\_4 (default)
- DCM\_OPVAL\_LEVEL\_3
- DCM\_OPVAL\_LEVEL\_2
- DCM\_OPVAL\_LEVEL\_1

This option specifies the level at which the DCM pre-resolves the model. 
Pre-resolving is one of the algorithms used with a DCM solve. 
Using the latest version of this algorithm will typically give the best performance in models that contain the affected constraints.

This switch is provided because this algorithm will affect the solution for under-defined models, so applications requiring the same solution as earlier versions of DCM may need to change the level and accept degraded performance as seen in those earlier versions. 
In general, level 4 should give the best results in terms of perofmance and behaviour.

There are currently four levels that will determine which constraint types are processed by this algorithm:

- Level 4 – This is the default mode and was introduced in version 75 of the 2D DCM. 
It is recommended for new integrators and for existing applications when operating on new models to give performance improvements. 
At this level, the algorithm processes the greatest range of pre-resolvable configurations related to symmetry, pattern and equal relative transform constraints. 
It is solving-mode specific, so that under-defined behavior matches the requirements of those modes.
- Level 3 –This was the default mode in versions 68 to 75. The improvement compared to the previous version was to limit the algorithm for certain solving modes to ensure the under-defined behaviour matched the requirements of those modes.
- Level 2 – This level was the default for version 67. At this level, the algorithm is extended to also process symmetry constraints and 1D patterns (linear and rotational) for all solving modes.
- Level 1 – At this level, only 2D (array) patterns and equal relative transforms are affected. 
This level is equivalent to the solving methods used in DCM in versions before 67.

#### 16.2.6.10 Control support for over-rigid models

Key: DCM\_OPKEY\_SOLVE\_ALL\_OVER\_RIGID

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

Over-rigid models are those involving constraints between geometry in a set or a rigid spline, and other sets or fixed geometries in which the scale of the set cannot be independently varied. 
For example, a set containing two points which are made coincident to two fixed points

This option allows applications to disable support for the over-rigid models and to mark such models as over-defined. 
This can be used when it is important to solve models in the same way that would have resulted in previous versions of the 2D DCM which did not support solving of over-rigid models (i.e. 
versions 48.0 and earlier).

#### 16.2.6.11 Control behaviour for equivalence class in autoconstrain

Key: DCM\_OPKEY\_VER\_AUTOCON\_EQUIV\_CLASS

- DCM\_OPVAL\_VER\_AUTOCON\_EQUIV\_CLASS\_66
- DCM\_OPVAL\_VER\_AUTOCON\_EQUIV\_CLASS\_67
- DCM\_OPVAL\_VER\_AUTOCON\_EQUIV\_CLASS\_CURRENT (default)

At the moment, the most recent version of the algorithm is activated by the two equivalent options \_67 and \_CURRENT. 
This could change in future versions. 
\_CURRENT is the default value of this option. 
The new algorithm for the autoconstrain functionality introduced in version 67 guarantees that each member of the equivalence classes output by the DCM could be constrained within the specified tolerance to all the other members of its equivalence class. 
Using option \_66 guarantees backward compatibility, and all members of an equivalence class are required to be equivalent only to the first class member.

#### 16.2.6.12 Include rigid linear equations in rigid constraint processing

Key: DCM\_OPKEY\_INFER\_RIGID\_EQUATIONS

- DCM\_OPVAL\_ON (default)
- DCM\_OPVAL\_OFF

This option controls the rigidity of linear equations for which the constant and coefficient terms cannot change (implicitly rigid equations). When a linear equation is added to the DCM, it is possible to specify the constant and coefficient terms directly in the relevant DCM interface functions (see [16.4.2 add\_e - Creates an equation in the DCM](16.4._DCM_functions_for_managing_equations.md)

When ON is specified:

- Any implicitly rigid linear equations will be included in the DCM’s rigid constraint processing.
- The DCM will solve models which are over-constrained but consistent (due to these equations) without marking the model as over-defined.

When OFF is specified:

- All implicitly rigid linear equations will be treated in the same way as other linear equations and will not be included in the DCM’s rigid constraint processing.
- The DCM will solve models which are over-constrained but consistent (due to these equations) as over-defined.

Prior to version 66 of the 2D DCM, implicitly rigid linear equations were not included in rigid constraint processing. 
To maintain this behaviour in later versions of the DCM, the application should specify OFF.

For version 66 and later, a new equation type DCM\_RIGID\_LINEAR\_EQUATION is available for creating rigid linear equations, which does not depend on the way constant and coefficient terms were specified. 
Linear equations with type DCM\_RIGID\_LINEAR\_EQUATION will always be treated as rigid, regardless of the setting of this option (see [12.5 Rigid equations](12.5._Rigid_equations.md)

#### 16.2.6.13 Suppress scaling centre enquiry and use the origin

Key: DCM\_OPKEY\_SCALING\_CENTRE

- DCM\_OPVAL\_SCALING\_CENTRE\_ENQUIRE (default)
- DCM\_OPVAL\_SCALING\_CENTRE\_ORIGIN

When scaling a set the application has a range of choices as to what scaling centre should be used, either to explicitly specify a point through the DCM\_scaling\_centre function, to use the origin, or to use a point selected by the DCM. 
In previous versions, these options were not available, and the origin was always used as the scaling centre. 
For backwards compatibility, this behaviour can be recalled using this option. 
The default behaviour is to use the improved behaviour, and if this option is not set to DCM\_OPVAL\_SCALING\_CENTRE\_ORIGIN, different behaviour may be observed from previous versions.

#### 16.2.6.14 Control if rigid dimensions are updated during an incremental evaluation

Key: DCM\_OPKEY\_INCREMENTAL\_RIGID\_DIMENSION\_UPDATE

- DCM\_OPVAL\_ON
- DCM\_OPVAL\_OFF (default)

This option specifies whether rigid dimensions can be updated during an incremental evaluation. 
This is not allowed by default in version 74.0 and later, since the value of a rigid dimension should be specific to each solve and not changed independently from all other constraints.

For backwards compatibility, i.e. 
to allow rigid dimensions to change during an incremental evaluation, the value DCM\_OPVAL\_ON should be set. 
This also influences the result of the model\_satisfied and satisfied functions, as explained in [16.5.24 model\_satisfied – Return if the constraints in a model are solved](16.5._Enquiry_functions.md)

#### 16.2.6.15 Control solving mode for directed distances

Key: DCM\_OPKEY\_DIRECTED\_DISTANCE\_MODE

- 0
- 1 (default)

This option enables enhanced processing of models containing directed distances in version 75.0 and later of the DCM. 
This should result in more efficient and predictable solving in general where these dimensions are used.

The enhancement is active by default.

For backwards compatibility, applications can cause DCM to revert to the old solving methods for directed distances, via setting the option value to 0.

The table below specifies the integer value which defines each key and value:

Key

Integer

DCM\_OPKEY\_ANALYSE\_UNSOLVED

10010

DCM\_OPKEY\_ANALYSE\_OVERDEFINED

10020

DCM\_OPKEY\_SOLVE\_NON\_ALGEBRAIC

10030

DCM\_OPKEY\_ABORT

10040

DCM\_OPKEY\_ALLOW\_ZERO\_RADIUS

10050

DCM\_OPKEY\_STATUS\_VERSION

10060

DCM\_OPKEY\_EVAL\_RESOLVE\_NOT\_CONSISTENT

10070

DCM\_OPKEY\_DRAG\_RESOLVE\_NOT\_CONSISTENT

10080

DCM\_OPKEY\_AUTOCON\_HELP\_POINTS

10090

DCM\_OPKEY\_AUTOCON\_CONSTRAINTS

10100

DCM\_OPKEY\_AUTOCON\_V49

10110

DCM\_OPKEY\_MINIMIZE\_HELP\_PARAMETER\_CHANGE

10120

DCM\_OPKEY\_ALLOW\_CIRCLE\_INVERSION

10130

DCM\_OPKEY\_INCREMENTAL\_HELP\_POINT\_UPDATE

10140

DCM\_OPKEY\_CHIRALITY\_STRICT

10150

DCM\_OPKEY\_DRAG\_CONSISTENT\_BEHAVIOUR

10160

DCM\_OPKEY\_SOLVE\_ALL\_OVER\_RIGID

10170

DCM\_OPKEY\_CHAIN\_SOLVING

10180

DCM\_OPKEY\_MANAGE\_CHANGING\_SOFT\_REFERENCES

10190

DCM\_OPKEY\_USE\_WORST\_PARTIAL\_STATUS

10200

DCM\_OPKEY\_SCALING\_CENTRE

10210

DCM\_OPKEY\_USE\_OPENMP

10220

DCM\_OPKEY\_AUTODIM\_ANGLES

10230

DCM\_OPKEY\_AUTODIM\_V56

10240

DCM\_OPKEY\_IDENTIFY\_SINGULAR\_UNDERDEFINED

10250

DCM\_OPKEY\_LARGE\_CHANGE\_SOLVING

10260

DCM\_OPKEY\_MODEL\_SATISFIED\_CHECK\_HELP\_POINTS

10270

DCM\_OPKEY\_MODEL\_SATISFIED\_FAST\_QUIT

10275

DCM\_OPKEY\_PRE\_RESOLVE\_LEVEL

10280

DCM\_OPKEY\_NORMAL\_SOLVING\_MODE

10290

DCM\_OPKEY\_DEDUCE\_CONSTRAINTS\_LEVEL

10300

DCM\_OPKEY\_INFER\_RIGID\_EQUATIONS

10310

DCM\_OPKEY\_VER\_AUTOCON\_EQUIV\_CLASS

10320

DCM\_OPKEY\_ALLOW\_RIGID\_CURVE\_LENGTH

10330

DCM\_OPKEY\_ALLOW\_RIGID\_ARC\_LENGTH

10340

DCM\_OPKEY\_UNI\_SCALABLE\_NEGATIVE\_SCALING

10350

DCM\_OPKEY\_BI\_SCALABLE\_NEGATIVE\_SCALING\_1

10370

DCM\_OPKEY\_BI\_SCALABLE\_NEGATIVE\_SCALING\_2

10380

DCM\_OPKEY\_FAIL\_DEGENERATE\_CONICS

10390

DCM\_OPKEY\_MULTITHREAD\_PARTITIONS\_MODE

10400

DCM\_OPKEY\_MULTITHREAD\_CURVELENGTH

10410

DCM\_OPKEY\_MOVE\_AND\_EVALUATE\_SOLVE\_STABILITY

10500

DCM\_OPKEY\_INCREMENTAL\_RIGID\_DIMENSION\_UPDATE

10430

DCM\_OPKEY\_DIRECTED\_DISTANCE\_MODE

10440

DCM\_OPVAL\_OFF

0

DCM\_OPVAL\_ON

1

DCM\_OPVAL\_ON\_OCC

2

DCM\_OPVAL\_LEVEL\_1

1

DCM\_OPVAL\_LEVEL\_2

2

DCM\_OPVAL\_LEVEL\_3

3

DCM\_OPVAL\_LEVEL\_4

4

DCM\_OPVAL\_VER\_66

66

DCM\_OPVAL\_VER\_67

67

DCM\_OPVAL\_VER\_400

400

DCM\_OPVAL\_VER\_410

410

DCM\_OPVAL\_VER\_420

420

DCM\_OPVAL\_VER\_CURRENT

1000

DCM\_OPVAL\_NORMAL\_TRANSLATION

0

DCM\_OPVAL\_NORMAL\_ROTATION

1

DCM\_OPVAL\_AUTODIM\_ANGLES\_ONE

0

DCM\_OPVAL\_AUTODIM\_ANGLES\_BOTH

1

DCM\_OPVAL\_ALLOW\_CIRCLE\_INVERSION\_OFF

0

DCM\_OPVAL\_ALLOW\_CIRCLE\_INVERSION\_ON

1

DCM\_OPVAL\_ALLOW\_CIRCLE\_INVERSION\_OFF\_STRICT

2

DCM\_OPVAL\_AUTOCON\_MIN\_CONSTRAINTS

0

DCM\_OPVAL\_AUTOCON\_MAX\_CONSTRAINTS

1

DCM\_OPVAL\_SCALING\_CENTRE\_ORIGIN

0

DCM\_OPVAL\_SCALING\_CENTRE\_ENQUIRE

1

### 16.2.7 option\_state - Return the current state of an option.

DCM\_set\_option\_return option\_state(int key, int\* value);

This function is used to enquire the current state of a global option. 
Given the key to enquire, DCM will return the current value.

### 16.2.8 option\_default - Return the default state of an option.

DCM\_set\_option\_return option\_default (int key, int\* value);

This function is used to enquire the defaut state of a global option. 
Given the key to enquire, DCM will return the default value.

### 16.2.9 set\_option - Old version

void set\_option(DCM\_option opt);

This version of the function takes a single entry from the DCM\_option struct. 
The effect is to set a DCM option key to a specific value. 
This interface is retained for backwards compatibility: All options available through this interface are also available in the new key/value pair interface.

In future, the DCM\_option struct will not be extended to add new values corresponding to additional DCM options and values, so applications should transition to the new version of the function where they are using this version.

In general there is a clear mapping between the types in the DCM\_option struct and the keys and values of used by the new set\_option function. 
The following exceptions should be considered:

- DCM\_OP\_DRAG\_RESOLVE\_NOT\_CONSISTENT\_ON



Using this option value is equivalent to using the higher value of the new key DCM\_OPKEY\_DRAG\_RESOLVE\_NOT\_CONSISTENT, which is currently level 2. It is only possible to revert to level 1 by using the new set\_option function.

