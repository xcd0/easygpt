## 10.4 円錐曲線への拘束

2D DCMでは、他のパラメトリック図形と同様に、[7.2 パラメトリック曲線の寸法と拘束](7.2._Dimensions_and_constraints_to_parametric_curves.md)で詳細に説明されているように、円錐曲線に対しても同じ拘束と寸法がサポートされています。

円錐曲線は方向を持つように定義されているため、この方向を制御する拘束もサポートされています。平行、直交、角度の制約があります。
円錐曲線の方向は、基礎となる無限大の円錐の軸に平行であると定義されています（上記参照）。

円錐曲線間の対称性と一致する拘束もサポートされていますが、以下の表に示す互換性のあるタイプに制限されています。

円錐曲線のタイプ

ノート

FIXED\_RHOとFIXED\_RHO

許可される：rhoの値は等しくなければならない

FIXED\_RHOとBEZIER

許可される

FIXED\_RHOとFIXED\_SHAPE

許可される：固定されたrhoの値は形状の範囲内になければならない

FIXED\_SHAPEとFIXED\_SHAPE

許可される：形状は同一でなければならない

FIXED\_SHAPEとBEZIER

許可されない

BEZIERとBEZIER

許可される

表6 対称性と一致する拘束の互換性のあるタイプ

パターンと等しい相対変換の拘束は、同じタイプと形状またはrho値（該当する場合）の円錐曲線にのみ許可されます。

以下の制約は、円錐曲線に対する制約に適用されます。

- 主/副半径 - 理論的には楕円の円錐曲線は主半径と副半径を持つと言えます。
しかし、DCM円錐曲線では、形状が固定されている場合でも、これらの制約の使用はサポートされていません。
- 同心の制約は、形状がDCM\_CONIC\_SHAPE\_PARABOLAである円錐曲線にのみ追加できます。
DCM\_CONIC\_SHAPE\_ELLIPSEの円錐曲線に対する同心の制約は現在サポートされていません。

### 10.4.1 rhoパラメータの寸法付け

2D DCMでは、DCM\_CONIC\_RHO寸法タイプを使用して、conic曲線のrhoパラメータに直接適用することができます。これには、r\_nodeを作成するためにadd\_r関数を使用します。

conic rho寸法は剛体にすることができます - このr\_nodeタイプに対しては、Frustum関数DCM\_dimension\_rigidが呼び出されます。

conic rho寸法は、適切なadd\_v関数を使用して変数（v\_node）に関連付けることができます。

conic rho寸法を駆動するためには、剛性が柔軟である必要があり、タイプはDCM\_CONIC\_TYPE\_BEZIERまたはDCM\_CONIC\_FIXED\_SHAPE\_BEZIERのいずれかである必要があります。
DCM\_CONIC\_FIXED\_SHAPE\_BEZIERタイプを使用する場合、形状は双曲線または楕円のいずれかであることができます。

固定形状のconic rho寸法が使用される場合、conic rho寸法の値は形状のconic rho範囲内にある必要があります。そうでない場合、conic rho寸法は整合性のない状態になります。

他のすべてのconicは剛性rho寸法に制約があります。
剛性conic rho寸法が使用される場合、値はDCM\_CONIC\_DATAで指定されたbezier\_rho値と一致する必要があります。そうでない場合、conicおよびそのconic rho寸法は過定義になります。

DCM関数：[add\_v](16.4._DCM_functions_for_managing_equations.md)

Frustum関数：[DCM\_dimension\_rigid](17.2._Basic_dimension_functions.md)

### 10.4.2 インクリメンタルソルバと円錐曲線

アプリケーションは、関数DCM\_update\_conicを使用して円錐曲線g\_nodesの定義を変更することができます。
この関数は、評価の間に呼び出すことも、DCMフラスタムコールバック（DCM\_conic\_updateから）内から呼び出すこともできます。アプリケーションが変更できる内容についてのルールは、これらの2つの状況によって異なります。

- 評価の間に - アプリケーションは、呼び出し元のフラスタム関数によって設定されたデータマスクによって指定された値のみを更新することができます。
これには、呼び出しのタイミングと曲線の初期定義によって、以下のビットのいくつかまたはすべてが含まれます：DCM\_CONIC\_BEZIER\_RHO
- 評価の外で - アプリケーションは、制御点の定義に使用されるg\_nodesの変更や、タイプの変更（例：freeからfixed-rhoへの変更）を含む、円錐曲線の任意の値を変更することができます。ただし、一部の変更はDCMのリセットを引き起こし、将来の評価で完全なソルブを行うように強制しますが、他の変更はインクリメンタルに行われます。

インクリメンタルソルブ（つまり、リセットを行わない）を許可する唯一の変更は、DCM\_CONIC\_BEZIER\_RHOです。
