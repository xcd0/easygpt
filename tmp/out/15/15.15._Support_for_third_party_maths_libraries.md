## 15.15 サードパーティの数学ライブラリのサポート

2D DCMは、解決モードに応じて、最も広範なモデルを解決できるようにするために、解析的な解法と数値解法の組み合わせを使用しています。
数値解法が使用されるモデルでは、アルゴリズムの一部が標準的な行列演算を実行します。
2D DCMには、これらの演算の内部実装があり、一般的なユーザーが使用する典型的なモデルに最適化されています。
しかし、非常に大きな行列に対してよりスケーラブルな代替アルゴリズムが利用可能です。
特に、LAPACKライブラリは、非常に大きなDCMモデルに対してより優れたパフォーマンスを提供するいくつかの関数を提供しています。

2D DCMには、LAPACKライブラリが提供する標準実装で特定のデフォルトの2D DCMアルゴリズムを置き換える仕組みが組み込まれています。
LAPACKルーチンは、2D DCMのバイナリに直接コンパイルされていません。代わりに、顧客はこれらのライブラリ関数を実装する関数を2D DCMに登録することができます。

その結果、非常に大きなモデルの解決が大幅に高速化され、特にLAPACKの実装が複数のプロセッサコアを利用できる場合にはさらに効果的です。

DCMは、新しい数学フラスタム関数を介してアプリケーションが外部数学関数を登録することを許可しています。
この登録は、既存のDCMフラスタムを介したアプリケーション関数の登録と同様です。
これらの関数は、DCMが内部的に行うより効率的に大規模な線形システムと単一値分解を解決するために、DCMによってオプションで呼び出されます。
アプリケーションがこれらの関数を登録しない場合、DCMは従来のDCM数学関数を使用します。
外部の数学ライブラリを使用する場合、指定された関数（このバージョンでは合計3つ）すべてを登録する必要があります。
1つ以上が登録されていない場合、従来のDCM数学関数が使用されます。

LAPACKアルゴリズムのMKL実装は、既存のDCM実装と比較して、特定のサイズを超えるモデルに対して改善されたパフォーマンスを提供することがわかっています。
小さなモデルでは、既存のDCMアルゴリズムの方が効率的で、より良い結果を提供します。
したがって、数値解法を必要とするほとんどのモデルは、DCM独自のアルゴリズムによって完全に処理されます。

DCMは、Intel MKLライブラリのバージョン10.3でテストされており、Windowsプラットフォームで動作します。
DCMはLAPACKの任意の実装で動作しない理由はありませんが、他の実装はテストされておらず、サポートされていないと見なされます。

### 15.15.1 LAPACK関数を使ったデバッグ

2D DCMでLAPACKアルゴリズムを使用する場合、ソルバーの動作に影響を与え、D-Cubedコンポーネントサポートに報告される問題の再現性に影響を与える可能性があります。
LAPACKを使用する場合のデバッグを支援するために、アプリケーションは数学ライブラリのFrustumバージョン関数maths_get_versionを登録して実装する必要があります。
これにより、DCMはジャーナルファイルに使用されるLAPACKライブラリのバージョンを書き出すことができます。これにより、D-Cubedは互換性のあるバージョンを使用して問題のデバッグを行うことができます。

他の2D DCMインターフェース呼び出しとは異なり、数学フラスタム関数への呼び出しは一般的にジャーナルファイルに書き出されません。
これは、出力されるデータの量が多いためであり、またこの情報は一般的に問題の再現に必要ではないためです。
数学関数のジャーナリングは、DCM_journal_optionsの新しいオプションを介してオンに切り替えることができます。
これはデフォルトではオフになっており、オンにするとジャーナルファイルが非常に大きくなる可能性があるため、このオプションは特定のバグに対してD-Cubedコンポーネントサポートから明示的に要求される場合を除いて、オフにしておくことをお勧めします。
