## 7.5 曲線の拡張

曲線の拡張は、パラメータ化された図形の両端に追加できる追加領域です。
これらの拡張は、元の曲線の両端に追加することも、オフセット曲線や楕円曲線の場合は元のパラメータ化内の位置に追加することもできます。その場合、拡張部分は元の曲線の残りを置き換えます。
曲線の拡張は、評価されたパラメトリック、スプライン、円錐曲線、オフセット曲線、楕円曲線に追加することができます。
曲線が拡張されると、拡張領域で曲線への拘束条件を解決することができます。

一般的に、曲線の拡張は次の2つのタイプのいずれかです：

- パラメータの制限を超えた拡張で、パラメータ範囲の端から始まります。
このタイプの拡張は、非周期的なスプライン、評価されたパラメトリック、オフセット曲線に使用することができます。
- 与えられたパラメータから始まる、固定または可変（アプリケーションによる）可能性のある別の有界曲線。このタイプの拡張は、オフセット曲線と楕円曲線にのみ使用することができます。

曲線の拡張の典型的な使用法は、有界曲線（オープンスプラインなど）の開始と終了を拡張することです。
ただし、周期的な図形と組み合わせる場合（このリリースでは楕円曲線のみサポートされています）、効果は周期的な曲線から有界曲線にジオメトリを変更し、有界部分が元の楕円曲線の一部であり、両端が拡張によって定義されることになります。
[図48：曲線の拡張](#_Ref75159190)は、スプラインのオフセットと直線のオフセットの間のギャップを埋めるために曲線の拡張が使用されている様子を示しています。
オフセット曲線の末尾には拡張（開始と終了の間のオフセットの一部）が適用されており、これは直線のオフセットと交差するほど長くなっています。

![fig43_curve_extension.bmp](../Resources/Images/2ddcm_manual/Curve extensions.png)

図48：曲線の拡張

曲線の拡張は、隣接するパラメトリックエッジのオフセットをサポートするために使用することができます：プロファイル内の2つの隣接する曲線が接線的に接合しない場合、これらの曲線からのオフセット曲線は一部の位置で接続されません。
この場合、オフセット曲線上で曲線の拡張を使用して、曲線を延長して接続することができます。

曲線の拡張を追加する際に、アプリケーションは次の情報を指定する必要があります：

- 曲線のどちらの端を拡張するか（片方または両方の端）。
- 各拡張について、それが曲線の端から始まるか、元のパラメータ範囲内から始まるか（楕円曲線とオフセット曲線のみ）。
- 各拡張について、拡張が始まりと終わるパラメータ。
- 曲線の拡張が直線かカスタムの形状かどうか。
カスタム曲線の拡張は、アプリケーションパラメトリックにのみ対応しています。
有界スプライン曲線には、追加の多項式拡張タイプが利用可能です（[7.5.2 多項式曲線の拡張](#_Ref404950394)を参照）。

### 7.5.1 線形曲線の拡張

線形曲線の場合、DCMは曲線の形状を内部で計算します。
線形拡張は、元の曲線に接線であり、始点での曲線の一次導関数が一定である場合、オフセット曲線の場合を除きます。
その場合、一次導関数はそのパラメータ値での基本曲線の一次導関数と等しくなります。

### 7.5.2 多項式曲線の拡張

DCM内で定義された周期的でない有界スプライン曲線については、既存の曲線定義を使用して曲線を拡張することができます。
DCMは、元のスプラインの一部を表す基になる多項式曲線を使用してスプライン曲線を拡張します。
有界スプライン曲線は、曲線のどちらの端からでも拡張することができ、指定された拡張終了パラメータに達するまで続きます。

DCMの他の曲線拡張タイプと同様に、拡張はDCM\_parametric\_extension\_dataを介して指定されます。
アプリケーションは、拡張タイプ（DCM\_PARA\_EXT\_TYPE\_BS\_POLYNOMIAL）と、どちらの端に拡張を追加するか（DCM\_PARA\_EXT\_END\_MINまたはDCM\_PARA\_EXT\_END\_MAX）を指定する必要があります。

多項式曲線の拡張は、元のパラメータ範囲の終わりからのみ作成できます（拡張開始タイプをDCM\_PARA\_EXT\_START\_TYPE\_ENDとして指定することにより）。他の拡張開始タイプ（既存の曲線のパラメータ空間内の代替有界曲線を定義するもの）は、オフセット曲線と楕円曲線にのみ対応しています。

柔軟な有理Bスプライン曲線（つまり、制御点の重み以外の値が1以外の場合）では、多項式曲線の拡張の安定性は通常、これらの場合には満足のいくものではありませんので、使用は推奨されません。

### 7.5.3 カスタム曲線の拡張

カスタム曲線の場合、アプリケーションは評価器を提供して、評価されたパラメトリックと同じ方法で曲線の形状を定義します。
このリリースでは、カスタム曲線の拡張では接線の大きさや方向の不連続はサポートされていませんが、拡張と元の曲線の接合部では接線の大きさの不連続が許可されています。
パラメトリックの拡張の評価器には別のフラスタム関数があります。
なお、DCM\_PARAMETRICタイプのg\_nodesの評価器関数は、拡張に対しては呼び出されません。
したがって、曲線の拡張が定義され、元のパラメータ範囲の一部を上書きするような場合、DCMは拡張上の位置を必要とする場合にはDCM\_parametric\_extension\_evaluatorを呼び出し、そのパラメータ値で元の曲線上の位置を必要とする場合にはDCM\_parametric\_evaluatorを呼び出します。

なお、拡張を基本曲線として使用してオフセット曲線を生成した場合、拡張は無視され、オフセット曲線は基本曲線の元のパラメータ範囲のみで定義されます。
1つの基本曲線を基に定義された複数のオフセット曲線がある場合、これらのオフセット曲線と基本曲線の拡張は独立して定義されなければなりません。

DCM関数: [update\_extensions](16.3._Defining_the_model_data.md)

フラスタム関数: [DCM\_parametric\_extension\_data](17.6._Frustum_functions_for_evaluated_parametrics_and_splines.md)
